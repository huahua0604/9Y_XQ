import{l as g,a as v}from"./demand-hymZzy6B.js";import{q as E,u as D,i as w,r as c,k as R,c as n,a as t,s as k,x as C,y as T,n as u,F as I,p as A,o as l,f as N,t as i,_ as V}from"./index-ByCBBT_F.js";import"./axios-B4yo9VEa.js";const B={class:"container my-4"},M={class:"d-flex align-items-center justify-content-between mb-3"},P={class:"card shadow-sm"},L={class:"card-body pb-2"},O={class:"nav nav-pills gap-2 mb-3"},F={class:"nav-item"},S={key:0,class:"d-flex align-items-center gap-2 text-muted py-4"},U={key:1},W={key:0,class:"table-responsive"},$={class:"table table-hover table-striped align-middle"},J=["onClick"],j={class:"text-body-secondary"},q={class:"fw-semibold"},z={class:"text-truncate",style:{"max-width":"520px"}},G={class:"d-flex flex-column"},H={class:"text-body-secondary"},K={class:"text-nowrap"},Q={key:1,class:"alert alert-light border d-flex align-items-center",role:"alert"},X=E({__name:"DemandList",setup(Y){const m=D();w(()=>m.user.roles?.includes("ADMIN")||m.user.roles?.includes("REVIEWER"));const r=c("mine"),o=c([]),d=c(!1);function _(s){return s?s.replace("T"," ").slice(0,19):""}function b(s){switch((s||"").toUpperCase()){case"DRAFT":return"text-bg-secondary";case"SUBMITTED":return"text-bg-info";case"IN_REVIEW":return"text-bg-primary";case"RETURNED":return"text-bg-warning";case"REJECTED":return"text-bg-danger";case"APPROVED":case"DONE":return"text-bg-success";default:return"text-bg-secondary"}}function h(s){const e=(s||"").trim();return["临时"].includes(e)?"text-bg-primary":["常态化(如:周报,月报等)"].includes(e)?"text-bg-info":["其他"].includes(e)?"text-bg-warning":"text-bg-secondary"}function y(s){switch(s){case"DRAFT":return"草稿";case"SUBMITTED":return"待主任审批";case"ADMIN_APPROVED":return"主任同意";case"ADMIN_REJECTED":return"主任驳回";case"REVIEW_APPROVED":return"科室同意";case"REVIEW_REJECTED":return"科室驳回";case"COMPLETED":return"已完成";default:return s||"未知"}}async function p(){d.value=!0;try{o.value=r.value==="mine"?await g():await v()}finally{d.value=!1}}function x(s){r.value!==s&&(r.value=s,p())}return R(p),(s,e)=>{const f=T("router-link");return l(),n("div",B,[t("div",M,[e[2]||(e[2]=t("h2",{class:"h4 mb-0"},"需求列表",-1)),k(f,{class:"btn btn-primary",to:"/demands/new"},{default:C(()=>[...e[1]||(e[1]=[t("span",{class:"me-1"},"+",-1),N(" 新建需求 ",-1)])]),_:1})]),t("div",P,[t("div",L,[t("ul",O,[t("li",F,[t("button",{class:u(["nav-link",{active:r.value==="mine"}]),onClick:e[0]||(e[0]=a=>x("mine"))}," 我的 ",2)])]),d.value?(l(),n("div",S,[...e[3]||(e[3]=[t("div",{class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},null,-1),t("span",null,"加载中…",-1)])])):(l(),n("div",U,[o.value.length?(l(),n("div",W,[t("table",$,[e[4]||(e[4]=t("thead",{class:"table-light"},[t("tr",null,[t("th",{style:{width:"90px"}},"ID"),t("th",null,"标题"),t("th",{style:{width:"120px"}},"申请类型"),t("th",{style:{width:"120px"}},"状态"),t("th",{style:{width:"120px"}},"提交人"),t("th",{style:{width:"180px"}},"提交时间")])],-1)),t("tbody",null,[(l(!0),n(I,null,A(o.value,a=>(l(),n("tr",{key:a.id,class:"cursor-pointer",onClick:Z=>s.$router.push(`/demands/${a.id}`)},[t("td",j,"#"+i(a.id),1),t("td",q,[t("div",z,i(a.title),1)]),t("td",null,[t("span",{class:u(["badge",h(a.category)])},i(a.category||"未分类"),3)]),t("td",null,[t("span",{class:u(["badge",b(a.status)])},i(y(a.status)),3)]),t("td",null,[t("div",G,[t("span",null,i(a.createdByName),1),t("small",H,i(a.createdByDept),1)])]),t("td",K,i(_(a.submittedAt||a.createdAt)),1)],8,J))),128))])])])):(l(),n("div",Q,[...e[5]||(e[5]=[t("i",{class:"bi bi-inbox me-2","aria-hidden":"true"},null,-1),t("div",null,"暂无数据",-1)])]))]))])])])}}}),at=V(X,[["__scopeId","data-v-b7aa0d1a"]]);export{at as default};
