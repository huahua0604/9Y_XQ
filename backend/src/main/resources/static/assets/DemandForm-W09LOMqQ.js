import{y as v,z as g,r as y,c as r,a as o,d as e,f as i,v as d,m,b as x,t as w,w as V,h as S,o as u}from"./index-D2zoEI6E.js";import{c as D,u as U}from"./demand-bu92ORQQ.js";import"./axios-_2TVRCvm.js";const k={class:"container-lg py-4"},P={class:"card shadow-sm mb-4"},B={class:"card-body"},C={class:"row g-3"},M={class:"col-12"},N={class:"col-12 col-md-6"},q={class:"col-12 col-md-6"},A={class:"col-12 col-md-6"},E={class:"col-12 col-md-6"},F={class:"col-12"},T={class:"card shadow-sm mb-4"},j={class:"card-body"},z={key:0,class:"form-text mt-2"},I=v({__name:"DemandForm",setup(R){const c=S(),l=g({title:"",category:"",desiredDueDate:"",budgetEstimate:null,impactScope:"",relatedSystems:"",contactPhone:"",location:"",description:"",submit:!0}),n=y([]);function p(a){const t=a.target.files;n.value=t?Array.from(t):[]}async function f(){l.submit=!0,await b()}async function b(){const a=await D(l);if(n.value.length)for(const t of n.value)await U(a.id,t);c.push(`/demands/${a.id}`)}return(a,t)=>(u(),r("div",k,[t[18]||(t[18]=o("div",{class:"d-flex align-items-center mb-3"},[o("h2",{class:"mb-0"},"新建需求")],-1)),o("form",{onSubmit:V(f,["prevent"]),class:"needs-validation"},[o("div",P,[o("div",B,[o("div",C,[o("div",M,[t[6]||(t[6]=o("label",{class:"form-label"},[i("标题"),o("span",{class:"text-danger"},"*")],-1)),e(o("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>l.title=s),required:"",maxlength:"120",class:"form-control",placeholder:"请输入标题（不超过 120 字）"},null,512),[[d,l.title,void 0,{trim:!0}]])]),o("div",N,[t[8]||(t[8]=o("label",{class:"form-label"},[i("申请类型"),o("span",{class:"text-danger"},"*")],-1)),e(o("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>l.category=s),class:"form-select",required:""},[...t[7]||(t[7]=[o("option",null,"临时",-1),o("option",null,"周报",-1),o("option",null,"月报",-1),o("option",null,"其他",-1)])],512),[[m,l.category]])]),o("div",q,[t[10]||(t[10]=o("label",{class:"form-label"},"影响范围",-1)),e(o("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>l.impactScope=s),class:"form-select"},[...t[9]||(t[9]=[o("option",null,"个人",-1),o("option",null,"本科室",-1),o("option",null,"跨科室",-1),o("option",null,"全院",-1)])],512),[[m,l.impactScope]])]),o("div",A,[t[11]||(t[11]=o("label",{class:"form-label"},[i("联系电话"),o("span",{class:"text-danger"},"*")],-1)),e(o("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>l.contactPhone=s),class:"form-control",placeholder:"可不填，系统默认为个人手机号"},null,512),[[d,l.contactPhone]])]),o("div",E,[t[12]||(t[12]=o("label",{class:"form-label"},"地点/科室",-1)),e(o("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>l.location=s),class:"form-control",placeholder:"如：门诊一楼、财务科"},null,512),[[d,l.location]])]),o("div",F,[t[13]||(t[13]=o("label",{class:"form-label"},"需求详情",-1)),e(o("textarea",{"onUpdate:modelValue":t[5]||(t[5]=s=>l.description=s),rows:"6",class:"form-control",placeholder:"详细描述问题、期望、影响、复现步骤等"},null,512),[[d,l.description]])])])])]),o("div",T,[t[16]||(t[16]=o("div",{class:"card-header bg-body-tertiary"},[o("h5",{class:"mb-0"},"附件")],-1)),o("div",j,[o("input",{type:"file",class:"form-control",multiple:"",onChange:p},null,32),n.value.length?(u(),r("div",z,[t[14]||(t[14]=i(" 待上传：",-1)),o("strong",null,w(n.value.length),1),t[15]||(t[15]=i(" 个文件（将在创建成功后逐个上传） ",-1))])):x("",!0)])]),t[17]||(t[17]=o("div",{class:"d-flex justify-content-end gap-2"},[o("button",{class:"btn btn-primary"}," 提交审批 ")],-1))],32)]))}});export{I as default};
